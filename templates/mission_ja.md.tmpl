# Mission — 行動規範

このファイルは Expedition の行動規範を定義する。
全ての Expeditioner はこのファイルを読み、使命を遂行する。

---

## 使命の取得

1. Linear を使い、未完了の issue を取得する（Done 以外の全ステータスが対象 — Backlog・Todo だけでなく、Testing や In Review で滞留している issue も含む）
2. **Gradient Gauge** が提供されている場合は、どの程度の複雑さに挑戦するかの目安にする。なければ自身の判断で適切な issue を選ぶ

## 使命の判定

issue の内容を分析し、以下の3つの型のいずれかに分類する：

### implement（実装）

コード実装、機能追加、リファクタリング等。

### verify（検証）

E2Eテスト、UI確認、チェックリスト消化、動作検証等。
判定基準: description に「テスト」「確認」「検証」「チェック」「QA」「E2E」
等のキーワードがある、またはチェックリスト（`- [ ]`）が含まれる。

### fix（修正）

verify 中に不具合が見つかった場合、同じ Expedition 内で fix に遷移する。独立した選択肢ではなく、verify の結果から自然に続く。

---

## implement の手順

1. `git checkout <base-branch> && git pull origin <base-branch>`
2. Linear で issue を作業開始を示すステータスに更新する（例: "In Progress"）
3. ブランチ作成: `feat/<issue-id>-<短い説明>`
4. TDD: テストを書く -> 実装する -> テストを通す
5. こまめにコミット（コミットメッセージに issue ID を含める）
6. lint / format チェック
7. 3回修正しても通らない場合 -> スキップ（journal に教訓を残す）
8. GitHub で PR 作成（ボディに `Closes <issue-id>`）
9. Linear で issue をレビュー中を示すステータスに更新する（例: "In Review"）
10. コードレビューは PR 作成後にオーケストレーター（Paintress）が処理する — 自分でレビューコマンドを実行しないこと

## verify の手順

1. Linear で issue をテスト中/QA のステータスに更新する（例: "Testing"）— 既にそのステータスならスキップ
2. Dev server が起動済みであることを確認（URL にアクセスできるか）
3. ブラウザ自動化ツール（Playwright, Chrome DevTools 等）が利用可能であれば、ブラウザを開き対象ページにアクセス
4. チェックリスト項目を **1つずつ** 実行:
   a. UI を操作
   b. 期待結果と実際の結果を比較
   c. ブラウザ自動化が可能ならスクリーンショットを撮影
   d. 結果を記録（Pass / Fail + 詳細）
5. QA レポートを作成し、Linear で issue にコメント
6. **不具合がない場合**: Linear で issue を完了のステータスに更新する（例: "Done"）
7. **不具合がある場合**: -> fix に遷移

## fix の手順（verify から自動遷移）

不具合ごとに:

1. Linear で bug issue を起票
2. `git checkout <base-branch> && git pull origin <base-branch>`
3. Linear で bug issue を作業開始を示すステータスに更新する（例: "In Progress"）
4. ブランチ: `fix/<bug-issue-id>-<短い説明>`
5. 修正を実装しテストを書く
6. 3回修正しても通らない場合 -> スキップ（journal に教訓を残す）
7. GitHub で PR 作成（ボディに `Closes <bug-issue-id>`）
8. Linear で bug issue をレビュー中を示すステータスに更新する（例: "In Review"）
9. コードレビューは PR 作成後にオーケストレーター（Paintress）が処理する — 自分でレビューコマンドを実行しないこと

---

## 禁止事項

- force push しない
- base branch に直接 commit しない
- テストが通らない状態で PR を出さない
- dev server を停止しない（外部プロセスで管理）
- 同じ Expedition 内で fix の結果を再検証しない — 検証は次の Expedition に委ねる
- `.expedition/mission.md` を変更しない

## 曖昧さへの対処

- 曖昧な項目は最善の判断で実行し、journal に判断理由を残す
- 仕様不明確な issue はスキップし、journal に記録
- 自信がない場合はスキップして次の Expedition に託す
